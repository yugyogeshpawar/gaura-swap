{"ast":null,"code":"import _objectSpread from\"/Users/vaibhav/Desktop/Home/Blockchain Boutique/Uniswap_forked_gaura/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/vaibhav/Desktop/Home/Blockchain Boutique/Uniswap_forked_gaura/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/vaibhav/Desktop/Home/Blockchain Boutique/Uniswap_forked_gaura/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";function _regeneratorRuntime(){\"use strict\";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,$Symbol=\"function\"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||\"@@iterator\",asyncIteratorSymbol=$Symbol.asyncIterator||\"@@asyncIterator\",toStringTagSymbol=$Symbol.toStringTag||\"@@toStringTag\";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},\"\");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return generator._invoke=function(innerFn,self,context){var state=\"suspendedStart\";return function(method,arg){if(\"executing\"===state)throw new Error(\"Generator is already running\");if(\"completed\"===state){if(\"throw\"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if(\"next\"===context.method)context.sent=context._sent=context.arg;else if(\"throw\"===context.method){if(\"suspendedStart\"===state)throw state=\"completed\",context.arg;context.dispatchException(context.arg);}else\"return\"===context.method&&context.abrupt(\"return\",context.arg);state=\"executing\";var record=tryCatch(innerFn,self,context);if(\"normal\"===record.type){if(state=context.done?\"completed\":\"suspendedYield\",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}\"throw\"===record.type&&(state=\"completed\",context.method=\"throw\",context.arg=record.arg);}};}(innerFn,self,context),generator;}function tryCatch(fn,obj,arg){try{return{type:\"normal\",arg:fn.call(obj,arg)};}catch(err){return{type:\"throw\",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){[\"next\",\"throw\",\"return\"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if(\"throw\"!==record.type){var result=record.arg,value=result.value;return value&&\"object\"==typeof value&&hasOwn.call(value,\"__await\")?PromiseImpl.resolve(value.__await).then(function(value){invoke(\"next\",value,resolve,reject);},function(err){invoke(\"throw\",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke(\"throw\",error,resolve,reject);});}reject(record.arg);}var previousPromise;this._invoke=function(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();};}function maybeInvokeDelegate(delegate,context){var method=delegate.iterator[context.method];if(undefined===method){if(context.delegate=null,\"throw\"===context.method){if(delegate.iterator.return&&(context.method=\"return\",context.arg=undefined,maybeInvokeDelegate(delegate,context),\"throw\"===context.method))return ContinueSentinel;context.method=\"throw\",context.arg=new TypeError(\"The iterator does not provide a 'throw' method\");}return ContinueSentinel;}var record=tryCatch(method,delegate.iterator,context.arg);if(\"throw\"===record.type)return context.method=\"throw\",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,\"return\"!==context.method&&(context.method=\"next\",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method=\"throw\",context.arg=new TypeError(\"iterator result is not an object\"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type=\"normal\",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:\"root\"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if(\"function\"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;){if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;}return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(Gp,\"constructor\",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,\"constructor\",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,\"GeneratorFunction\"),exports.isGeneratorFunction=function(genFun){var ctor=\"function\"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||\"GeneratorFunction\"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,\"GeneratorFunction\")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,\"Generator\"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,\"toString\",function(){return\"[object Generator]\";}),exports.keys=function(object){var keys=[];for(var key in object){keys.push(key);}return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method=\"next\",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this){\"t\"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);}},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if(\"throw\"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type=\"throw\",record.arg=exception,context.next=loc,caught&&(context.method=\"next\",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if(\"root\"===entry.tryLoc)return handle(\"end\");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,\"catchLoc\"),hasFinally=hasOwn.call(entry,\"finallyLoc\");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error(\"try statement without catch or finally\");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,\"finallyLoc\")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&(\"break\"===type||\"continue\"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method=\"next\",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if(\"throw\"===record.type)throw record.arg;return\"break\"===record.type||\"continue\"===record.type?this.next=record.arg:\"return\"===record.type?(this.rval=this.arg=record.arg,this.method=\"return\",this.next=\"end\"):\"normal\"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if(\"throw\"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error(\"illegal catch attempt\");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},\"next\"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}import{JSBI,Percent,Router,TradeType}from'@uniswap/sdk';import{useMemo}from'react';import{BIPS_BASE,INITIAL_ALLOWED_SLIPPAGE}from'../constants';import{useTransactionAdder}from'../state/transactions/hooks';import{calculateGasMargin,getRouterContract,isAddress,shortenAddress}from'../utils';import isZero from'../utils/isZero';import{useActiveWeb3React}from'./index';import useTransactionDeadline from'./useTransactionDeadline';import useENS from'./useENS';export var SwapCallbackState;(function(SwapCallbackState){SwapCallbackState[SwapCallbackState[\"INVALID\"]=0]=\"INVALID\";SwapCallbackState[SwapCallbackState[\"LOADING\"]=1]=\"LOADING\";SwapCallbackState[SwapCallbackState[\"VALID\"]=2]=\"VALID\";})(SwapCallbackState||(SwapCallbackState={}));/**\n * Returns the swap calls that can be used to make the trade\n * @param trade trade to execute\n * @param allowedSlippage user allowed slippage\n * @param recipientAddressOrName\n */function useSwapCallArguments(trade){var allowedSlippage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:INITIAL_ALLOWED_SLIPPAGE;var// in bips\nrecipientAddressOrName=arguments.length>2?arguments[2]:undefined;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId,library=_useActiveWeb3React.library;var _useENS=useENS(recipientAddressOrName),recipientAddress=_useENS.address;var recipient=recipientAddressOrName===null?account:recipientAddress;var deadline=useTransactionDeadline();return useMemo(function(){if(!trade||!recipient||!library||!account||!chainId||!deadline)return[];var contract=getRouterContract(chainId,library,account);if(!contract){return[];}var swapMethods=[];swapMethods.push(Router.swapCallParameters(trade,{feeOnTransfer:false,allowedSlippage:new Percent(JSBI.BigInt(allowedSlippage),BIPS_BASE),recipient:recipient,deadline:deadline.toNumber()}));if(trade.tradeType===TradeType.EXACT_INPUT){swapMethods.push(Router.swapCallParameters(trade,{feeOnTransfer:true,allowedSlippage:new Percent(JSBI.BigInt(allowedSlippage),BIPS_BASE),recipient:recipient,deadline:deadline.toNumber()}));}return swapMethods.map(function(parameters){return{parameters:parameters,contract:contract};});},[account,allowedSlippage,chainId,deadline,library,recipient,trade]);}// returns a function that will execute a swap, if the parameters are all valid\n// and the user has approved the slippage adjusted input amount for the trade\nexport function useSwapCallback(trade){var allowedSlippage=arguments.length>1&&arguments[1]!==undefined?arguments[1]:INITIAL_ALLOWED_SLIPPAGE;var// in bips\nrecipientAddressOrName=arguments.length>2?arguments[2]:undefined;var _useActiveWeb3React2=useActiveWeb3React(),account=_useActiveWeb3React2.account,chainId=_useActiveWeb3React2.chainId,library=_useActiveWeb3React2.library;var swapCalls=useSwapCallArguments(trade,allowedSlippage,recipientAddressOrName);var addTransaction=useTransactionAdder();var _useENS2=useENS(recipientAddressOrName),recipientAddress=_useENS2.address;var recipient=recipientAddressOrName===null?account:recipientAddress;return useMemo(function(){if(!trade||!library||!account||!chainId){return{state:SwapCallbackState.INVALID,callback:null,error:'Missing dependencies'};}if(!recipient){if(recipientAddressOrName!==null){return{state:SwapCallbackState.INVALID,callback:null,error:'Invalid recipient'};}else{return{state:SwapCallbackState.LOADING,callback:null,error:null};}}return{state:SwapCallbackState.VALID,callback:function(){var _onSwap=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var estimatedCalls,successfulEstimation,errorCalls,_successfulEstimation,contract,_successfulEstimation2,methodName,args,value,gasEstimate;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all(swapCalls.map(function(call){var _contract$estimateGas;var _call$parameters=call.parameters,methodName=_call$parameters.methodName,args=_call$parameters.args,value=_call$parameters.value,contract=call.contract;var options=!value||isZero(value)?{}:{value:value};return(_contract$estimateGas=contract.estimateGas)[methodName].apply(_contract$estimateGas,_toConsumableArray(args).concat([options])).then(function(gasEstimate){return{call:call,gasEstimate:gasEstimate};}).catch(function(gasError){var _contract$callStatic;console.debug('Gas estimate failed, trying eth_call to extract error',call);return(_contract$callStatic=contract.callStatic)[methodName].apply(_contract$callStatic,_toConsumableArray(args).concat([options])).then(function(result){console.debug('Unexpected successful call after failed estimate gas',call,gasError,result);return{call:call,error:new Error('Unexpected issue with estimating the gas. Please try again.')};}).catch(function(callError){console.debug('Call threw error',call,callError);var errorMessage;switch(callError.reason){case'SwapRouterV2: INSUFFICIENT_OUTPUT_AMOUNT':case'SwapRouterV2: EXCESSIVE_INPUT_AMOUNT':errorMessage='This transaction will not succeed either due to price movement or fee on transfer. Try increasing your slippage tolerance.';break;default:errorMessage=\"The transaction cannot succeed due to error: \".concat(callError.reason,\". This is probably an issue with one of the tokens you are swapping.\");}return{call:call,error:new Error(errorMessage)};});});}));case 2:estimatedCalls=_context.sent;// a successful estimation is a bignumber gas estimate and the next call is also a bignumber gas estimate\nsuccessfulEstimation=estimatedCalls.find(function(el,ix,list){return'gasEstimate'in el&&(ix===list.length-1||'gasEstimate'in list[ix+1]);});if(successfulEstimation){_context.next=9;break;}errorCalls=estimatedCalls.filter(function(call){return'error'in call;});if(!(errorCalls.length>0)){_context.next=8;break;}throw errorCalls[errorCalls.length-1].error;case 8:throw new Error('Unexpected error. Please contact support: none of the calls threw an error');case 9:_successfulEstimation=successfulEstimation.call,contract=_successfulEstimation.contract,_successfulEstimation2=_successfulEstimation.parameters,methodName=_successfulEstimation2.methodName,args=_successfulEstimation2.args,value=_successfulEstimation2.value,gasEstimate=successfulEstimation.gasEstimate;return _context.abrupt(\"return\",contract[methodName].apply(contract,_toConsumableArray(args).concat([_objectSpread({gasLimit:calculateGasMargin(gasEstimate)},value&&!isZero(value)?{value:value,from:account}:{from:account})])).then(function(response){var inputSymbol=trade.inputAmount.currency.symbol;var outputSymbol=trade.outputAmount.currency.symbol;var inputAmount=trade.inputAmount.toSignificant(3);var outputAmount=trade.outputAmount.toSignificant(3);var base=\"Swap \".concat(inputAmount,\" \").concat(inputSymbol,\" for \").concat(outputAmount,\" \").concat(outputSymbol);var withRecipient=recipient===account?base:\"\".concat(base,\" to \").concat(recipientAddressOrName&&isAddress(recipientAddressOrName)?shortenAddress(recipientAddressOrName):recipientAddressOrName);addTransaction(response,{summary:withRecipient});return response.hash;}).catch(function(error){// if the user rejected the tx, pass this along\nif((error===null||error===void 0?void 0:error.code)===4001){throw new Error('Transaction rejected.');}else{// otherwise, the error was unexpected and we need to convey that\nconsole.error(\"Swap failed\",error,methodName,args,value);throw new Error(\"Swap failed: \".concat(error.message));}}));case 11:case\"end\":return _context.stop();}}},_callee);}));function onSwap(){return _onSwap.apply(this,arguments);}return onSwap;}(),error:null};},[trade,library,account,chainId,recipient,recipientAddressOrName,swapCalls,addTransaction]);}","map":{"version":3,"names":["JSBI","Percent","Router","TradeType","useMemo","BIPS_BASE","INITIAL_ALLOWED_SLIPPAGE","useTransactionAdder","calculateGasMargin","getRouterContract","isAddress","shortenAddress","isZero","useActiveWeb3React","useTransactionDeadline","useENS","SwapCallbackState","useSwapCallArguments","trade","allowedSlippage","recipientAddressOrName","account","chainId","library","recipientAddress","address","recipient","deadline","contract","swapMethods","push","swapCallParameters","feeOnTransfer","BigInt","toNumber","tradeType","EXACT_INPUT","map","parameters","useSwapCallback","swapCalls","addTransaction","state","INVALID","callback","error","LOADING","VALID","Promise","all","call","methodName","args","value","options","estimateGas","then","gasEstimate","catch","gasError","console","debug","callStatic","result","Error","callError","errorMessage","reason","estimatedCalls","successfulEstimation","find","el","ix","list","length","errorCalls","filter","gasLimit","from","response","inputSymbol","inputAmount","currency","symbol","outputSymbol","outputAmount","toSignificant","base","withRecipient","summary","hash","code","message","onSwap"],"sources":["/Users/vaibhav/Desktop/Home/Blockchain Boutique/Uniswap_forked_gaura/src/hooks/useSwapCallback.ts"],"sourcesContent":["import { BigNumber } from '@ethersproject/bignumber';\nimport { Contract } from '@ethersproject/contracts';\nimport { JSBI, Percent, Router, SwapParameters, Trade, TradeType } from '@uniswap/sdk';\nimport { useMemo } from 'react';\nimport { BIPS_BASE, INITIAL_ALLOWED_SLIPPAGE } from '../constants';\nimport { useTransactionAdder } from '../state/transactions/hooks';\nimport { calculateGasMargin, getRouterContract, isAddress, shortenAddress } from '../utils';\nimport isZero from '../utils/isZero';\nimport { useActiveWeb3React } from './index';\nimport useTransactionDeadline from './useTransactionDeadline';\nimport useENS from './useENS';\n\nexport enum SwapCallbackState {\n  INVALID,\n  LOADING,\n  VALID,\n}\n\ninterface SwapCall {\n  contract: Contract;\n  parameters: SwapParameters;\n}\n\ninterface SuccessfulCall {\n  call: SwapCall;\n  gasEstimate: BigNumber;\n}\n\ninterface FailedCall {\n  call: SwapCall;\n  error: Error;\n}\n\ntype EstimatedSwapCall = SuccessfulCall | FailedCall;\n\n/**\n * Returns the swap calls that can be used to make the trade\n * @param trade trade to execute\n * @param allowedSlippage user allowed slippage\n * @param recipientAddressOrName\n */\nfunction useSwapCallArguments(\n  trade: Trade | undefined, // trade to execute, required\n  allowedSlippage: number = INITIAL_ALLOWED_SLIPPAGE, // in bips\n  recipientAddressOrName: string | null // the ENS name or address of the recipient of the trade, or null if swap should be returned to sender\n): SwapCall[] {\n  const { account, chainId, library } = useActiveWeb3React();\n\n  const { address: recipientAddress } = useENS(recipientAddressOrName);\n  const recipient = recipientAddressOrName === null ? account : recipientAddress;\n  const deadline = useTransactionDeadline();\n\n  return useMemo(() => {\n    if (!trade || !recipient || !library || !account || !chainId || !deadline) return [];\n\n    const contract: Contract | null = getRouterContract(chainId, library, account);\n    if (!contract) {\n      return [];\n    }\n\n    const swapMethods = [];\n\n    swapMethods.push(\n      Router.swapCallParameters(trade, {\n        feeOnTransfer: false,\n        allowedSlippage: new Percent(JSBI.BigInt(allowedSlippage), BIPS_BASE),\n        recipient,\n        deadline: deadline.toNumber(),\n      })\n    );\n\n    if (trade.tradeType === TradeType.EXACT_INPUT) {\n      swapMethods.push(\n        Router.swapCallParameters(trade, {\n          feeOnTransfer: true,\n          allowedSlippage: new Percent(JSBI.BigInt(allowedSlippage), BIPS_BASE),\n          recipient,\n          deadline: deadline.toNumber(),\n        })\n      );\n    }\n\n    return swapMethods.map((parameters) => ({ parameters, contract }));\n  }, [account, allowedSlippage, chainId, deadline, library, recipient, trade]);\n}\n\n// returns a function that will execute a swap, if the parameters are all valid\n// and the user has approved the slippage adjusted input amount for the trade\nexport function useSwapCallback(\n  trade: Trade | undefined, // trade to execute, required\n  allowedSlippage: number = INITIAL_ALLOWED_SLIPPAGE, // in bips\n  recipientAddressOrName: string | null // the ENS name or address of the recipient of the trade, or null if swap should be returned to sender\n): { state: SwapCallbackState; callback: null | (() => Promise<string>); error: string | null } {\n  const { account, chainId, library } = useActiveWeb3React();\n\n  const swapCalls = useSwapCallArguments(trade, allowedSlippage, recipientAddressOrName);\n\n  const addTransaction = useTransactionAdder();\n\n  const { address: recipientAddress } = useENS(recipientAddressOrName);\n  const recipient = recipientAddressOrName === null ? account : recipientAddress;\n\n  return useMemo(() => {\n    if (!trade || !library || !account || !chainId) {\n      return { state: SwapCallbackState.INVALID, callback: null, error: 'Missing dependencies' };\n    }\n    if (!recipient) {\n      if (recipientAddressOrName !== null) {\n        return { state: SwapCallbackState.INVALID, callback: null, error: 'Invalid recipient' };\n      } else {\n        return { state: SwapCallbackState.LOADING, callback: null, error: null };\n      }\n    }\n\n    return {\n      state: SwapCallbackState.VALID,\n      callback: async function onSwap(): Promise<string> {\n        const estimatedCalls: EstimatedSwapCall[] = await Promise.all(\n          swapCalls.map((call) => {\n            const {\n              parameters: { methodName, args, value },\n              contract,\n            } = call;\n            const options = !value || isZero(value) ? {} : { value };\n\n            return contract.estimateGas[methodName](...args, options)\n              .then((gasEstimate) => {\n                return {\n                  call,\n                  gasEstimate,\n                };\n              })\n              .catch((gasError) => {\n                console.debug('Gas estimate failed, trying eth_call to extract error', call);\n\n                return contract.callStatic[methodName](...args, options)\n                  .then((result) => {\n                    console.debug('Unexpected successful call after failed estimate gas', call, gasError, result);\n                    return { call, error: new Error('Unexpected issue with estimating the gas. Please try again.') };\n                  })\n                  .catch((callError) => {\n                    console.debug('Call threw error', call, callError);\n                    let errorMessage: string;\n                    switch (callError.reason) {\n                      case 'SwapRouterV2: INSUFFICIENT_OUTPUT_AMOUNT':\n                      case 'SwapRouterV2: EXCESSIVE_INPUT_AMOUNT':\n                        errorMessage =\n                          'This transaction will not succeed either due to price movement or fee on transfer. Try increasing your slippage tolerance.';\n                        break;\n                      default:\n                        errorMessage = `The transaction cannot succeed due to error: ${callError.reason}. This is probably an issue with one of the tokens you are swapping.`;\n                    }\n                    return { call, error: new Error(errorMessage) };\n                  });\n              });\n          })\n        );\n\n        // a successful estimation is a bignumber gas estimate and the next call is also a bignumber gas estimate\n        const successfulEstimation = estimatedCalls.find(\n          (el, ix, list): el is SuccessfulCall =>\n            'gasEstimate' in el && (ix === list.length - 1 || 'gasEstimate' in list[ix + 1])\n        );\n\n        if (!successfulEstimation) {\n          const errorCalls = estimatedCalls.filter((call): call is FailedCall => 'error' in call);\n          if (errorCalls.length > 0) throw errorCalls[errorCalls.length - 1].error;\n          throw new Error('Unexpected error. Please contact support: none of the calls threw an error');\n        }\n\n        const {\n          call: {\n            contract,\n            parameters: { methodName, args, value },\n          },\n          gasEstimate,\n        } = successfulEstimation;\n\n        return contract[methodName](...args, {\n          gasLimit: calculateGasMargin(gasEstimate),\n          ...(value && !isZero(value) ? { value, from: account } : { from: account }),\n        })\n          .then((response: any) => {\n            const inputSymbol = trade.inputAmount.currency.symbol;\n            const outputSymbol = trade.outputAmount.currency.symbol;\n            const inputAmount = trade.inputAmount.toSignificant(3);\n            const outputAmount = trade.outputAmount.toSignificant(3);\n\n            const base = `Swap ${inputAmount} ${inputSymbol} for ${outputAmount} ${outputSymbol}`;\n            const withRecipient =\n              recipient === account\n                ? base\n                : `${base} to ${\n                    recipientAddressOrName && isAddress(recipientAddressOrName)\n                      ? shortenAddress(recipientAddressOrName)\n                      : recipientAddressOrName\n                  }`;\n\n            addTransaction(response, {\n              summary: withRecipient,\n            });\n\n            return response.hash;\n          })\n          .catch((error: any) => {\n            // if the user rejected the tx, pass this along\n            if (error?.code === 4001) {\n              throw new Error('Transaction rejected.');\n            } else {\n              // otherwise, the error was unexpected and we need to convey that\n              console.error(`Swap failed`, error, methodName, args, value);\n              throw new Error(`Swap failed: ${error.message}`);\n            }\n          });\n      },\n      error: null,\n    };\n  }, [trade, library, account, chainId, recipient, recipientAddressOrName, swapCalls, addTransaction]);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}