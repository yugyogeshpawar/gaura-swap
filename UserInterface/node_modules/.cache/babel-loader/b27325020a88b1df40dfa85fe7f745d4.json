{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar color_1 = require(\"./color\");\n\nvar builder_1 = __importDefault(require(\"./builder\"));\n\nvar Util = __importStar(require(\"./util\"));\n\nvar Quantizer = __importStar(require(\"./quantizer\"));\n\nvar Generator = __importStar(require(\"./generator\"));\n\nvar Filters = __importStar(require(\"./filter\"));\n\nvar defaults = require(\"lodash/defaults\");\n\nvar Vibrant =\n/** @class */\nfunction () {\n  function Vibrant(_src, opts) {\n    this._src = _src;\n    this.opts = defaults({}, opts, Vibrant.DefaultOpts);\n    this.opts.combinedFilter = Filters.combineFilters(this.opts.filters);\n  }\n\n  Vibrant.from = function (src) {\n    return new builder_1.default(src);\n  };\n\n  Vibrant.prototype._process = function (image, opts) {\n    var quantizer = opts.quantizer,\n        generator = opts.generator;\n    image.scaleDown(opts);\n    return image.applyFilter(opts.combinedFilter).then(function (imageData) {\n      return quantizer(imageData.data, opts);\n    }).then(function (colors) {\n      return color_1.Swatch.applyFilter(colors, opts.combinedFilter);\n    }).then(function (colors) {\n      return Promise.resolve(generator(colors));\n    });\n  };\n\n  Vibrant.prototype.palette = function () {\n    return this.swatches();\n  };\n\n  Vibrant.prototype.swatches = function () {\n    return this._palette;\n  };\n\n  Vibrant.prototype.getPalette = function (cb) {\n    var _this = this;\n\n    var image = new this.opts.ImageClass();\n    var result = image.load(this._src).then(function (image) {\n      return _this._process(image, _this.opts);\n    }).then(function (palette) {\n      _this._palette = palette;\n      image.remove();\n      return palette;\n    }, function (err) {\n      image.remove();\n      throw err;\n    });\n    if (cb) result.then(function (palette) {\n      return cb(null, palette);\n    }, function (err) {\n      return cb(err);\n    });\n    return result;\n  };\n\n  Vibrant.Builder = builder_1.default;\n  Vibrant.Quantizer = Quantizer;\n  Vibrant.Generator = Generator;\n  Vibrant.Filter = Filters;\n  Vibrant.Util = Util;\n  Vibrant.Swatch = color_1.Swatch;\n  Vibrant.DefaultOpts = {\n    colorCount: 64,\n    quality: 5,\n    generator: Generator.Default,\n    ImageClass: null,\n    quantizer: Quantizer.MMCQ,\n    filters: [Filters.Default]\n  };\n  return Vibrant;\n}();\n\nexports.default = Vibrant;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA;;AAEA;;AAEA;;AAEA;;AACA;;AACA;;AAEA;;AAEA;AAAA;AAAA;EAuBE,iBAAoBA,IAApB,EAAuCC,IAAvC,EAA8D;IAA1C;IAClB,KAAKA,IAAL,GAA6BC,QAAQ,CAAC,EAAD,EAAKD,IAAL,EAAWE,OAAO,CAACC,WAAnB,CAArC;IACA,KAAKH,IAAL,CAAUI,cAAV,GAA2BC,OAAO,CAACC,cAAR,CAAuB,KAAKN,IAAL,CAAUO,OAAjC,CAA3B;EACD;;EATML,eAAP,UAAYM,GAAZ,EAA4B;IAC1B,OAAO,IAAIC,iBAAJ,CAAYD,GAAZ,CAAP;EACD,CAFM;;EAUCN,6BAAR,UAAiBQ,KAAjB,EAA+BV,IAA/B,EAAoD;IAC5C,aAAS,GAAgBA,IAAI,UAA7B;IAAA,IAAWW,SAAS,GAAKX,IAAI,UAA7B;IAENU,KAAK,CAACE,SAAN,CAAgBZ,IAAhB;IAEA,OAAOU,KAAK,CAACG,WAAN,CAAkBb,IAAI,CAACI,cAAvB,EACJU,IADI,CACC,UAACC,SAAD,EAAU;MAAK,gBAAS,CAACA,SAAS,CAACC,IAAX,EAAiBhB,IAAjB,CAAT;IAA+B,CAD/C,EAEJc,IAFI,CAEC,UAACG,MAAD,EAAO;MAAK,sBAAOJ,WAAP,CAAmBI,MAAnB,EAA2BjB,IAAI,CAACI,cAAhC;IAA+C,CAF5D,EAGJU,IAHI,CAGC,UAACG,MAAD,EAAO;MAAK,cAAO,CAACC,OAAR,CAAgBP,SAAU,CAACM,MAAD,CAA1B;IAAmC,CAHhD,CAAP;EAID,CATO;;EAWRf;IACE,OAAO,KAAKiB,QAAL,EAAP;EACD,CAFD;;EAGAjB;IACE,OAAO,KAAKkB,QAAZ;EACD,CAFD;;EAIAlB,yCAAWmB,EAAX,EAAiC;IAAjC;;IACE,IAAIX,KAAK,GAAG,IAAI,KAAKV,IAAL,CAAUsB,UAAd,EAAZ;IACA,IAAMC,MAAM,GAAGb,KAAK,CAACc,IAAN,CAAW,KAAKzB,IAAhB,EACZe,IADY,CACP,UAACJ,KAAD,EAAM;MAAK,YAAI,CAACe,QAAL,CAAcf,KAAd,EAAqBgB,KAAI,CAAC1B,IAA1B;IAA+B,CADnC,EAEZc,IAFY,CAEP,UAACa,OAAD,EAAQ;MACZD,KAAI,CAACN,QAAL,GAAgBO,OAAhB;MACAjB,KAAK,CAACkB,MAAN;MACA,OAAOD,OAAP;IACD,CANY,EAMV,UAACE,GAAD,EAAI;MACLnB,KAAK,CAACkB,MAAN;MACA,MAAMC,GAAN;IACD,CATY,CAAf;IAUA,IAAIR,EAAJ,EAAQE,MAAM,CAACT,IAAP,CAAY,UAACa,OAAD,EAAQ;MAAK,SAAE,CAAC,IAAD,EAAQA,OAAR,CAAF;IAAkB,CAA3C,EAA6C,UAACE,GAAD,EAAI;MAAK,SAAE,CAACA,GAAD,CAAF;IAAO,CAA7D;IACR,OAAON,MAAP;EACD,CAdD;;EA5COrB,kBAAUO,iBAAV;EACAP,oBAAY4B,SAAZ;EACA5B,oBAAY6B,SAAZ;EACA7B,iBAASG,OAAT;EACAH,eAAO8B,IAAP;EACA9B,iBAAS+B,cAAT;EAEA/B,sBAAgC;IACrCgC,UAAU,EAAE,EADyB;IAErCC,OAAO,EAAE,CAF4B;IAGrCxB,SAAS,EAAEoB,SAAS,CAACK,OAHgB;IAIrCd,UAAU,EAAE,IAJyB;IAKrCe,SAAS,EAAEP,SAAS,CAACQ,IALgB;IAMrC/B,OAAO,EAAE,CAACF,OAAO,CAAC+B,OAAT;EAN4B,CAAhC;EAoDT;AAAC,CA5DD;;AA8DAG,kBAAerC,OAAf","names":["_src","opts","defaults","Vibrant","DefaultOpts","combinedFilter","Filters","combineFilters","filters","src","builder_1","image","generator","scaleDown","applyFilter","then","imageData","data","colors","resolve","swatches","_palette","cb","ImageClass","result","load","_process","_this","palette","remove","err","Quantizer","Generator","Util","color_1","colorCount","quality","Default","quantizer","MMCQ","exports"],"sourceRoot":"","sources":["../src/vibrant.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}